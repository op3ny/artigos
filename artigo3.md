# Artigo 3
## Versão original
Olá leitor(a)! É um prazer ter você aqui! Neste repositório, eu guardo basicamente a escrita original dos artigos, mesmo que com erros de português ou erros de lógica, a idéia é guardar o primeiro rascunho! Caso você queira algo mais fácil de entender, melhor escrito, e mais polido, recomendo ver diretamente no blog, [clique aqui!](https://blog.hsyst.org)

## Artigo em sí
Título: HPS, o exemplo perfeito
Descrição: Neste artigo, falarei sobre o HPS, o exemplo perfeito de programação além do código.

—> Introdução
Hey! Nesse artigo, vamos falar um pouco sobre uma plataforma que eu mesma desenvolvi, o HPS (Hsyst Peer to Peer (P2P) Service). Essa plataforma resolve problemas reais de aplicações P2P típicos, e principalmente, não deixa de ser um projeto "além do código".

Para quem não entendeu a referência, no último artigo falei um pouco, de forma introdutória, mas bem reflexiva sobre o fato de que a programação é uma área extremamente versátil, e muito além da lógica e da sintaxe, ele consegue tranquilamente expandir para várias outras áreas, saindo desde economia e filosofia, para artes e psicologia.

Ainda seguindo com o tema do artigo anterior, meu objetivo aqui é falar um pouco mais a fundo sobre um dos temas introduzidos pelo artigo "A programação além do código", que é: "Afinal, qual projeto realmente implementa várias áreas em um lugar só?", e "Qual é sua visão de mundo?", e o HPS é uma aplicação que responde, na minha opinião, de forma bem clara essas dúvidas.

--> O que é HPS?
Como falei nesse mesmo artigo durante a introdução, no artigo anterior, eu abordei de forma introdutória o que seria "programar além do código", e deixei em aberto várias perguntas a serem discutidas, como por exemplo, a minha visão de mundo e a falta de um exemplo real de projeto que implementou várias áreas de conhecimento em apenas um código, e com o HPS eu vou explicar isso. Mas antes de explicar a minha visão de mundo aplicada ao HPS, a filosofia aplicada ao HPS, e a economia aplicada ao HPS, eu preciso explicar o que afinal de contas seria o HPS.

Eu poderia responder isso tranquilamente de forma resumida que o HPS seria algo como um "Sistema pseudo descentralizado federado", ou simplesmente "Um protocolo P2P que tem servidor", mas isso torna a frase levemente contraditória, afinal, como um sistema descentralizado (P2P) poderia ser centralizado (servidores)? E é aí que isso me obriga a fazer uma explicação mais detalhada do que seria o HPS.

Então sem mais enrolações, o HPS é um protocolo, a partir do momento em que ele delimita como máquinas devem se comunicar entre sí, e o protocolo HPS é aplicado ao HPS Server, que seria ao servidor que executa uma instância HPS para acesso público, e o HPS Browser, que seria a aplicação que permite o uso da rede para pessoas leigas (ou pelo menos, que não leriam o código inteiro para usar com postman ou algo assim skskask). Falando de forma prática, ele tem basicamente um mecanismo de economia, onde você pode minerar uma moeda ($HPS), que com ela, você pode realizar uploads na rede (que gera um HASH para esse arquivo, que serve para conseguir acessa-lo e evidenciar adulterações, e tem uma assinatura PGP para confirmar que você tem autoria sob aquele arquivo), registro de DNSs (Nome legível como teste.hps que direciona para o HASH do arquivo, também contendo assinatura e HASH pra evidenciar adulterações no DNS).

A mineração, permite que você receba quantidades de $HPS, e esses $HPS que você recebe por minerar, são o lastro da moeda, assim, cada moeda é um voucher (arquivo) que contém a assinatura do servidor emissor, um hash, assinatura do(a) dono(a) desse voucher, e o desafio PoW anexado para verificação. Quanto mais você minera, mais pendências de assinatura você adquire, onde a cada 2 pendências de assinatura, 1 você pode resolver através do pagamento de uma multa, que vai diretamente para a custódia que subsidia aumento de preços por conta da mineração (além de taxas de transferência), e outra pendência de assinatura só pode ser resolvida assinando uma transferência. Digamos que você esteja fazendo um upload com seu saldo de $HPS, você transfere esse valor pro servidor, e antes de transferir, o minerador tem que verificar o PoW, de onde veio aquele voucher, e a validade daquele voucher, e com o minerador aprovando, ele recebe uma taxa pela verificação, e a transação é realizada.

O upload, é basicamente um upload comum, mas você precisa de saldo de $HPS para realizar o upload, ou realizar um PoW que vai diretamente para o nome da custódia, em outras palavras, minerar $HPS para a custódia para pagar o seu gasto. Esse arquivo, quando chega no servidor, fica acessível pelo HASH designado a ele na finalização do upload. Quando você acessa aquele arquivo, seu browser guarda uma cópia daquele arquivo, e exibe o arquivo. Caso o arquivo seja apagado do servidor, qualquer cliente pode enviar sua cópia do arquivo para o servidor, e caso esteja adulterado, é fácil de identificar, afinal, o hash do arquivo não será igual ao hash solicitado.

Quando você realiza o login, basicamente você envia ao servidor que você está se conectando, todos os servidores que você conhece e arquivos que você tem. Isso permite que o servidor atual sincronize arquivos dele com outros servidores, e permite que ele defina um servidor de backup, ou seja, caso o servidor atual caia, você já sabe o servidor que o servidor atual escolheu pra você se conectar caso ele caisse, assim, diminui a perda de arquivos, afinal, quem acessou aquele servidor e tinha arquivos daquele servidor, está no mesmo servidor que você está agora, afinal, é o mesmo servidor de backup pra todo mundo, facilitando encontrar pessoas que tenham o arquivo que você precisa.

Além disso, caso o servidor não tenha um arquivo, ele basicamente faz o que qualquer sistema P2P faz, mas servindo de ponte. Ou seja, ele responde ao cliente que pediu o arquivo falando que não tem o arquivo, e em seguida, pergunta a todos da rede se alguém tem o arquivo com o hash pedido. Quem tiver, envia ao servidor, o servidor armazena uma cópia, e envia a cópia para quem pediu.

--> Qual problema ele resolve?
Simples! Hoje em dia, por conta da escassez de IPV4 (e.x:. 192.168.0.0), os provedores optaram por utilizar um mecanismo chamado de CGNAT (outra opção, seria usar IPV6, mas por conta da dificuldade na migração, os provedores optaram pelo CGNAT). O CGNAT é basicamente a arte de usar um mesmo IP para o máximo de dispositivos possíveis, mas diferentemente do NAT convencional, que é basicamente o provedor dar um IP para o roteador da sua casa, e todos os dispositivos conectados naquele roteador recebem o mesmo IPV4, o CGNAT simplesmente utiliza uma versão ainda mais agressiva, onde mais se um roteador, geralmente no mesmo bairro, compartilham do mesmo IP.

Porém, você deve estar se perguntando qual é o problema disso, e realmente não é tão óbvio pra quem ainda não está habituado com esse tema, mas o problema é relativamente simples de entender: Se vários roteadores estão usando o mesmo IP, e o IP seria a identificação daquele dispositivo, como eu iria me comunicar diretamente com ele?

Respondendo essa pergunta, a resposta é bem simples: não tem como! Você teria que iniciar uma conexão com um IP que esteja recebendo conexões normalmente, para então, usar dessa conexão em aberto pra se comunicar, pois desse modo, o provedor sabe de onde veio a requisição e associa ao dispositivo as respostas para aquela requisição. O problema está quando o sistema é P2P, onde muitas pessoas estão por trás de um CGNAT, e assim, ninguém consegue de comunicar com ninguém por conta do CGNAT, e o sistema oficialmente não funciona.

Diante disso, a solução dada pelo HPS é relativamente simples, vamos criar um servidor que tem IP próprio, e torna-lo o mais descartável possível, ou seja, identificação feita por chaves PGP (e portanto, identificação universal), verificação de integridade por HASH (e logo, universal), e dentre outros mecanismos. Graças a isso, se um servidor cair, sem problemas, em questão de segundos (ou minutos dependendo do quão congestionado), os arquivos já estarão recuperados, e livre de adulterações. Além disso, o HPS usa o PoW (Proof of Work) para trazer um custo para ações, o que inibe ataques, permite um acúmulo de poder computacional gasto (a moeda $HPS), e garante que simplesmente a rede continue em funcionamento, e livre de ataques, afinal, o PoW é globalmente verificável, então falsificar uma prova de trabalho é simplesmente impossivel sem gastar mais ou igual poder computacional.

--> Perfeito, e a economia?
Acho que estamos começando a ter um direcionamento aqui, e é na verdade uma ótima pergunta. A economia do HPS parece algo simples: minerou, fez gasto de poder computacional, remuneração.

Na verdade, o poço é bem mais fundo, e incrivelmente, muita coisa que eu nem sequer pensei que eu iria colocar em um lugar, vai se encaixar perfeitamente aqui (apertem os cintos asksak). Primeiro, lembre do momento em que eu falei que o sistema cobra multas para resolver um certo tipo de pendência de assinatura, e esse valor ajuda a subsidiar inflação e taxas de assinatura. Perfeito, esse é o ponto, a conta que cuida disso é a custódia, e a custódia em sí, é o mesmo que recebe o valor gasto em compras, e isso inicia um ciclo de incentivos: A cada quantidade de minerações que você realiza, você paga multas que subsidiam a inflação que sua mineração está gerando e a taxa de custódia que você vai receber caso alguém transfira $HPS. Caso você gaste com por exemplo, uploads, esse valor vai pra custódia que subsidia novamente os preços, ou seja, o gasto abaixa o preço ao envés de aumentar, e incentiva o gasto. Além disso, o dinheiro na custódia não é "prisioneiro", ele é distribuido novamente em forma de taxas de assinatura para mineradores, que esse valor recebido em taxas, vão voltar a circular.

Indo mais a fundo, você deve estar se perguntando (ou não, mas agora você vai): "mas e quando o $HPS minerado em um servidor, vale menos do que o minerado em outro? Afinal, servidores tem preços diferentes". Essa pergunta está correta, e é aí que entra o sistema de câmbio, ou seja, quando você pega o servidor (A) que tem a taxa de inflação (comparado ao estado original do servidor), de 2x, e manda 100 HPS para o servidor (B) que tem a inflação de 1x, o que vai acontecer é que, um minerador do servidor B vai se comunicar com A, pedindo relatórios da economia do servidor dele, e dados do voucher para verificar se ele é verdadeiro. Caso tudo esteja certo, simplesmente o servidor (A) destroi 100 HPS lá, e o servidor (B) cria 50 HPSs, e agora, o câmbio está correto. Afinal, você continua com o mesmo poder de compra que o servidor (A), e isso garante justiça com quem minerou nesse servidor.

Por fim, esse sistema incentiva que você utilize servidores que tem uma economia controlada, afinal, você não vai querer perder 30s pra minerar um voucher de 4 $HPS, que na verdade, em outro servidor nesse mesmo tempo, você mineraria 4 $HPS que no servidor que você está agora, seriam 8 $HPS, logo, isso garante que o/a administrador(a) do servidor não tenha incentivos para mecher na custódia, afinal, servidores desestabilizados, tendem a ser menos confiáveis.

--> Eu ouvi filosofia?
Esse sistema ele tem um embasamento filosófico (especialmente filosófico-político) bem forte, digo basicamente de um sistema que dá soberania ao indivíduo que está utilizando esse sistema, removendo a soberania do controle central (servidor), garante propriedade privada (afinal, você pode transferir seus bens, seja $HPS, domínios ou até mesmo arquivos para qualquer pessoa), responsabilidade individual (afinal, você escolhe qual servidor você quer usar, inclusive um servidor inseguro, mas quem arca com as consequências é você), e principalmente, remove o poder do Estado.

Como disse no último post, também citado na introdução desse artigo ("A programação além do código"), eu citei o exemplo do Satoshi Nakamoto que criou o Bitcoin, graças a sua visão filosófica e econômica, ele criou uma moeda que remove o poder do Estado, e criou uma invenção capaz de fazer uma moeda praticamente inviolável, e extremamente segura.

Não vou mentir, esse projeto foi embasado teóricamente, de forma bem forte no Bitcoin, desde o modo de lastro da moeda (PoW), até a ideia de remover o poder do Estado. Acho que é possível concluir que é bem libertário uma ideia de um projeto que traz propriedade privada, soberania ao indivíduo, e responsabilidade individual. Então, essa conclusão está correta, esse projeto é libertário, e ouso dizer que pode ser considerado até cripto-anarquista por conta de toda a sua estrutura, e outro ponto que me inspirei em Satoshi Nakamoto (Bitcoin), foi exatamente a pergunta de "Como remover o poder do Estado?", e ele responde isso extremamente bem (e melhor do que eu planejei na verdade). Claro, ele tem trade-offs claros, problemas, e muitas melhorias pela frente, mas sem dúvidas foi simplesmente um projeto muito bem embasado na minha opinião. Caso um servidor seja obrigado a remover um arquivo para seguir uma ordem estatal, simplesmente isso não surte efeito, afinal, basta uma pessoa ter o arquivo, e o servidor volta a ter aquele arquivo apagado, ou, simplesmente aquele arquivo é propagado para outros servidores.

Além disso, é também uma solução empreendedora, afinal, mais do que reclamar sobre o CGNAT das operadoras, e chama-las de todos os tipos de insultos diferentes, simplesmente elaborei uma solução para contornar o problema, utilizando exatamente dessa arquitetura de software demonstrada acima, então isso prova na prática, que não importa o problema, sempre terá (mesmo que demore), alguém com tempo o suficiente pra tentar resolver um problema.

--> O fim da utopia...
Fico feliz em dizer que a utopia acabou aqui, afinal, precisamos entender que essa não é a solução para a fome no mundo, ou nesse caso, a solução para todos os problemas, e claro que temos várias pontuações (negativas, claro) a serem feitas aqui.

Apesar de um serviço, na minha opinião, bem embasado teóricamente, é evidente que ao abrir a sua interface e documentação pela primeira vez, a interface é simplesmente confusa. Isso é um problema clássico de projetos como esse, e assim, isso dificulta as pessoas conseguirem aderir ao projeto.

Outro problema evidente, é que um trade-off feito é simples, quem tiver que fizer upload de um arquivo, deve realizar um PoW. Porém, quem tiver um arquivo que o servidor não tem, pode enviar no login para o servidor armazenar. Isso abre brecha para que alguém simplesmente crie vários arquivos legítimos, e mande ao servidor atual ao logar, e realize apenas uma Prova de Trabalho, para vários arquivos. Isso é um problema sem solução (eu acho), inclusive convido a quem tiver coragem de opinar, de dizer uma solução pra esse problema, afinal, estou desenvolvendo a próxima atualização do HPS, e você pode ser creditado(a) se sua ideia funcionar :)

Temos também, o problema da centralização. É óbvio que a ideia do projeto é tornar servidores descartáveis, e sim, já considerei o fato de que caso não tenham mais servidores online na rede por causa de censuras automatizadas como o Grande Firewall chinês, o mercado teria um incentivo para criar um servidor (afinal, quem conseguir torna-lo acessível e conhecido, simplesmente terá monopólio do protocolo na região). Porém, realmente existe um risco (e relativamente alto), de isso criar um ciclo de: muitos servidores funcionando, censura pega, nenhum funciona, aparece um, funciona, é censurado, aparece vários, são censurados, e em um gráfico, virar literalmente um limbo seguido de uma subida histórica de servidores.

Uma solução pro problema acima, poderia ser a auto-custódia dos dados, ou seja, seu servidor, seus dados, você pode ter amigos(as) para cruzarem informações, ou seja, um usa o servidor do outro e os servidores sincronizam entre sí, o que torna o serviço invisível, mas criaria o problema da escalabilidade, ou seja, simplesmente ele não conseguiria ficar famoso, caso contrário, seria pego na censura. Então, deixo essa reflexão aqui.

Outra coisa meio impopular que eu fiz, foi usar certificados SSL/TLS auto-assinados para o serviço, e então, desativar a checagem de certificados, afinal, caso eu implementasse um SSL/TLS de uma certificadora, bastaria a certificadora parar de emitir certificados para esse tipo de servidor em países com censura, e a censura censurar serviços de certificação (SSL/TLS), e pronto! Você acabou com todo o sistema de criptografia de ponta a ponta. Isso cria sim, problemas de segurança caso um atacante consiga pinnar no início um certificado dele e começar a conversar com você, mas eu deixo a reflexão: Será que é melhor a segurança do cliente, ou da rede? E preferir a segurança da rede (como eu escolhi), não seria violar um princípio filosófico do projeto?

Por último, por que criar um projeto tão complexo para resolver um problema tão simples? Já existem soluções pra isso! E sim, eu concordo plenamente, mas esse projeto tenta criar uma alternativa sem ser anônima, ou seja, com identificação (mesmo que pseudônica) de quem fez o upload, além de trazer alguns mecanismos... peculiares.... eu diria. Mas a reflexão que eu deixo é: Será que valeu a pena reinventar a roda?

--> Finalização
Talvez, realmente um projeto como esse seja chatinho de planejar, e só por esse artigo, já deu pra entender que não é lá algo tão simples, mas reinventar a roda, pelo menos pra mim, foi bem divertido, e aprendi bastante coisa com isso. Apesar de ter uma proposta, acredito que seja mais um projeto de nicho, e sinceramente, isso não tem nenhum problema. Afinal, a ideia do projeto realmente era criar algo mais pessoal, pra uso próprio, pra ter uma espécie de "NAS distribuído" com algumas ideias fora da curva.

Espero que vocês tenham gostado desse post, e até mais! Caso queira entrar em contato, use um dos meios abaixo.

E-mail: thaisdzini@proton.me / thais@hsyst.org
Discord: op3n
GitHub: github.com/op3ny

